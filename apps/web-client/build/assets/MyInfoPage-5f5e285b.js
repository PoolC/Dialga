import{w as L,h as T,a as o,l as w,M as p,j as c,s as N,t as $}from"./index-04133603.js";import{A as k}from"./AuthForm-44bd2021.js";import{b as H,u as d}from"./member-b1b02566.js";import{r as V,s as v}from"./axiosUtil-094ba110.js";import{S as P}from"./Spinner-84267176.js";import{S as n}from"./statusCode-196b1b17.js";import"./Modal-a94156ed.js";import"./throttle-6f972964.js";import"./getFileUrl-459fc159.js";import"./Block.styles-4dce9da8.js";const Q=({location:q,history:a})=>{const h=T(),[l,S]=o.useState(!0),[i,g]=o.useState(!0),[M,s]=o.useState(null),[R,m]=o.useState(!1),[x,E]=o.useState(null),[I,O]=o.useState(null),t=()=>{m(!0)},U=()=>{m(!1)};o.useEffect(()=>{(async()=>(V(),v(),w().then(e=>{e.status===n.OK&&(E(e.data),S(!1))}).catch(e=>{console.error(e.message),a.push(`/${p.FORBIDDEN}`)})))()},[a]),o.useEffect(()=>{(async()=>H().then(e=>{e.status===n.OK&&(O(e.data.data),g(!1))}).catch(e=>{console.error(e.message),a.push(`/${p.FORBIDDEN}`)}))()},[a]);function b(e){s(e)}const j=({name:e,password:r,passwordCheck:y,email:D,phoneNumber:K,introduction:A,profileImageURL:B})=>{try{N({name:e,password:r,passwordCheck:y,email:D,phoneNumber:K,introduction:A,profileImageURL:B}).then(u=>{u.status===n.OK&&(s("성공적으로 회원정보를 수정했습니다."),t())}).catch(u=>{if(u.response.status===409){s("이미 가입된 정보입니다."),t();return}if(u.response.status===400){s("모든 값을 올바르게 입력해주세요."),t();return}s("정보 수정 실패"),t()})}catch(f){console.error(f)}},C=({role:e})=>{d({role:e}).then(r=>{r.status===n.OK&&(s("성공적으로 회원 상태를 수정했습니다."),t())}).catch(r=>{console.error(r),s("회원 상태 수정 실패"),t()})},F=()=>{d({role:"QUIT"}).then(e=>{e.status===n.OK&&(alert("성공적으로 풀씨에서 탈퇴했습니다."),setTimeout(()=>{h($()),a.push("/")},1500))}).catch(e=>{console.error(e),s("회원 탈퇴 실패"),t()})};return c.jsxs(c.Fragment,{children:[(l||i)&&c.jsx(P,{}),!(l||i)&&c.jsx(k,{type:"update",onSubmit:j,message:M,onChangeMessage:b,modalVisible:R,handleModalOpen:t,handleModalClose:U,userInfo:x,roles:I,onUpdateMemberRoleBySelf:C,onWithdraw:F})]})},W=L(Q),oe=()=>c.jsx(W,{});export{oe as default};
